<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>

  <link href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css" rel="stylesheet">
  <script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/holistic/holistic.js" crossorigin="anonymous"></script>


  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Glide.js/3.2.0/glide.min.js"></script>

  <!-- <link href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css" rel="stylesheet"> -->
  <!-- <script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script> -->


  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.min.js"
    integrity="sha512-pumBsjNRGGqkPzKHndZMaAG+bir374sORyzM3uulLV14lN5LyykqNk8eEeUlUkB3U0M4FApyaHraT65ihJhDpQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.js"
    integrity="sha512-6DC1eE3AWg1bgitkoaRM1lhY98PxbMIbhgYCGV107aZlyzzvaWCW1nJW2vDuYQm06hXrW0As6OGKcIaAVWnHJw=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.slim.js"
    integrity="sha512-G1QAKkF7DrLYdKiz55LTK3Tlo8Vet2JnjQHuJh+LnU0zimJkMZ7yKZ/+lQ/0m94NC1EisSVS1b35jugu3wLdQg=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.slim.min.js"
    integrity="sha512-fYjSocDD6ctuQ1QGIo9+Nn9Oc4mfau2IiE8Ki1FyMV4OcESUt81FMqmhsZe9zWZ6g6NdczrEMAos1GlLLAipWg=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>


</head>
<style>
  * {
    margin: 0px;
    padding: 0px;
  }
</style>

<body>

  <video id="vid" src="" style="display: none;"></video>
  <!-- <script src="webcam.js"></script> -->

  <div id="my_camera" style="width:320px; height:240px;"></div>
  <div id="my_result"></div>

  <div class="container">
    <!-- <video class="input_video" width="0px" height="0px"></video> -->
    <canvas class="output_canvas" style="transform:rotateY(180deg);position: relative;">
    </canvas>
  </div>

  <div style="position: relative;">
    <video id="webcam" style="width: 1280px; height: 720px; position: abso" autoplay playsinline></video>
    <canvas class="output_canvas" id="output_canvas" width="1280" height="720"
      style="position: absolute; left: 0px; top: 0px;"></canvas>
  </div>
  <span style="background-color: red;width: auto;overflow: visible;height: 0px;position: absolute;" id="imgsec">
    <img src="@.png" alt="" style="width:100%">
  </span>

  <button id="webcamButton" class="mdc-button mdc-button--raised">
    <span class="mdc-button__ripple"></span>
    <span class="mdc-button__label">ENABLE WEBCAM</span>
  </button>

  <!-- 
  <script >
    
    
     
      

// let handLandmarker = undefined;
let runningMode = "IMAGE";
let enableWebcamButton=document.getElementById("webcamButtons");
let webcamRunning=false;
const videoHeight = "360px";
const videoWidth = "480px";


/********************************************************************
// Demo 2: Continuously grab image from webcam stream and detect it.
********************************************************************/



const video = document.getElementById("webcam") ;
const canvasElement = document.getElementById("output_canvas");
// const canvasCtx = canvasElement.getContext("2d");

// Check if webcam access is supported.
const hasGetUserMedia = () => !!(navigator.mediaDevices?.getUserMedia);

// If webcam supported, add event listener to button for when user
// wants to activate it.
if (hasGetUserMedia()) {
  enableWebcamButton = document.getElementById("webcamButton");
  enableWebcamButton.addEventListener("click", enableCam);


// Enable the live webcam view and start detection.
function enableCam(event) {
//   if (!handLandmarker) {
//     console.log("Wait! objectDetector not loaded yet.");
//     return;
//   }

console.log(webcamRunning)

  if (webcamRunning === true) {
    webcamRunning = false;
    enableWebcamButton.innerText = "ENABLE PREDICTIONS";
  } else {
    webcamRunning = true;
    enableWebcamButton.innerText = "DISABLE PREDICITONS";
  }

  // getUsermedia parameters.
  const constraints = {
    video: true
  };

  // Activate the webcam stream.
  navigator.mediaDevices.getUserMedia(constraints).then((stream) => {
    video.srcObject = stream;

    const hands = new Hands({
      locateFile: (file) => {
        return `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`;
      }
    });
    var block = document.getElementsByTagName('body');

    hands.setOptions({
      maxNumHands: 1,
      modelComplexity: 1,
      minDetectionConfidence: 0.5,
      minTrackingConfidence: 0.8
    });
    const camera = new Camera(video, {
      onFrame: async () => {
        await hands.send({ image: video });
      },
      width: block.width,
      height: block.height,
    });
    camera.start();
  });
}


    
    function coords(x, y) {
      
      
      if (ox - x >= 10) {
        console.log('left')
        // r-=100;
      } else if (Math.abs(ox - x) >= 10) {
        console.log('right')
        // r-=100;
      } else if (oy - y >= 15) {
        console.log('up');
      } else if (y - oy >= 15) {
        console.log('down');
      } else {
        // modelViewer.cameraOrbit=`${oldscale}deg ${s}deg 1rad`;
      }
      ox = x;
      oy = y;
    }

    // function coords(x,y,z)
    // {
    //   // console.log(x,y);
    //   var element=document.getElementById('gameBlock');
    //   var Bx=(element.clientWidth/100);
    //   var By=(element.clientHeight/100);
    //   // console.log(Bx*x,By*y);

    //   // console.log(element.clientWidth,element.clientHeight)
    //   document.getElementById('vLine').style=`height:5px;width:5px;position: absolute;top: ${By*y}px;right: ${Bx*x}px;background-color: black;transform: rotate(90deg);`
    //   // document.getElementById('hLine').style=`height:5px;width:100%;position: absolute;top:${By*y}px;left:0px;background-color: aqua;`
    // }

    function coordsForW(x, y, z) {
      // console.log(x,y);
      var element = document.getElementById('gameBlock');
      var Bx = (element.clientWidth / 100);
      var By = (element.clientHeight / 100);
      // console.log(Bx*x,By*y);

      document.getElementById('WLine').style = `height:5px;width:5px;position: absolute;top: ${By * y}px;right: ${Bx * x}px;background-color: green;transform: rotate(90deg);`
      // document.getElementById('hLine').style=`height:5px;width:100%;position: absolute;top:${By*y}px;left:0px;background-color: aqua;`
    }
    function coordsForP(x, y, z) {
      console.log(x, y, z);
      var element = document.getElementById('gameBlock');
      var Bx = (element.clientWidth / 100);
      var By = (element.clientHeight / 100);
      // console.log(Bx*x,By*y);

      // console.log(element.clientWidth,element.clientHeight)
      document.getElementById('PLine').style = `height:5px;width:5px;position: absolute;top: ${By * y}px;right: ${Bx * x}px;background-color: yellow;transform: rotate(90deg);`
      // document.getElementById('hLine').style=`height:5px;width:100%;position: absolute;top:${By*y}px;left:0px;background-color: aqua;`
    }
    function coordsForT(x, y, z) {
      console.log(x, y, z);
      var element = document.getElementById('gameBlock');
      var Bx = (element.clientWidth / 100);
      var By = (element.clientHeight / 100);
      // console.log(Bx*x,By*y);

      // console.log(element.clientWidth,element.clientHeight)
      document.getElementById('TLine').style = `height:5px;width:5px;position: absolute;top: ${By * y}px;right: ${Bx * x}px;background-color: red;transform: rotate(90deg);`
      // document.getElementById('hLine').style=`height:5px;width:100%;position: absolute;top:${By*y}px;left:0px;background-color: aqua;`
    }


    var max = 0, count = 0, oldmax = 0;
    // console.log(canvasElement.height)
    async function onResults(results) {
    await hands.send({ image: video });

      canvasCtx.save();
      canvasCtx.clearRect(0, 0, canvasElement.width, canvasElement.height);
      canvasCtx.drawImage(
        results.image, 0, 0, canvasElement.width, canvasElement.height);
      if (results.multiHandLandmarks) {
        for (const landmarks of results.multiHandLandmarks) {
          if (start == 0) {
            ox = landmarks[12].x;
            start++;
          } else {

            max = Math.abs(
              Math.sqrt(
                Math.abs((landmarks[5].x - landmarks[9].x) * (landmarks[5].x - landmarks[9].x)) +
                Math.abs((landmarks[5].y - landmarks[9].y) * (landmarks[5].y - landmarks[9].y))
              )) * canvasElement.width;;
            console.log(max);
            try {
              if (window.innerWidth < 1000) {
                document.getElementById('imgsec').style = `top:${(((landmarks[13].y + landmarks[14].y) / 2) * canvasElement.height)}px;
              right:${(((landmarks[13].x + landmarks[14].x) / 2) * canvasElement.width) - (window.innerWidth * 0.003)}px
              ;z-index:1;background-color: transparent;width: ${max}px;height: auto;position: absolute;transform:translate(50%,-50%);`
              } else {
                document.getElementById('imgsec').style = `top:${(((landmarks[13].y + landmarks[14].y) / 2) * canvasElement.height)}px;
              right:${(((landmarks[13].x + landmarks[14].x) / 2) * canvasElement.width) - (window.innerWidth * 0.01)}px
              ;z-index:1;background-color: transparent;width: ${max}px;height: auto;position: absolute;transform:translate(50%,-50%);`

              }
            } catch (e) {
              console.log(e)
            }
            // coords(landmarks[12].x * 100, landmarks[12].y * 100)
          }

          // var deg = Math.atan((landmarks[4].y - landmarks[20].y) / (landmarks[4].x - landmarks[20].x)) * 180 / 3.14;
          // if (deg < 0) {
          //   deg = 180 + deg;
          // } else {
          //   deg = deg;
          // }
          // console.log(Math.round(90-deg))
          // if (Math.round(90 - deg) % 10 == 0) {
          //   document.getElementById('rectForTM').style.transform = `rotate(${90 - deg}deg)`;
          //   document.getElementById('rectForMM').style.transform = `rotate(${90 - deg}deg)`;
          //   document.getElementById('rectForBM').style.transform = `rotate(${90 - deg}deg)`;
          // }


          drawConnectors(canvasCtx, landmarks, HAND_CONNECTIONS,
            { color: 'transparent', lineWidth: 1 });
          // drawLandmarks(canvasCtx, landmarks, {color: '#FF0000', lineWidth: 1});
        }
      }
      canvasCtx.restore();
    }

    
const holistic = new Holistic({locateFile: (file) => {
  return `https://cdn.jsdelivr.net/npm/@mediapipe/holistic/${file}`;
}});
holistic.setOptions({
  modelComplexity: 1,
  smoothLandmarks: true,
  enableSegmentation: true,
  smoothSegmentation: true,
  refineFaceLandmarks: true,
  minDetectionConfidence: 0.5,
  minTrackingConfidence: 0.5
});
holistic.onResults(onResults);

const camera = new Camera(video, {
  onFrame: async () => {
    await holistic.send({image: video});
  },
  width: 1280,
  height: 720
});
camera.start();
    
  
    
  
  };
  
  </script> -->
<script>
  let runningMode = "IMAGE";
  let enableWebcamButton=document.getElementById("webcamButtons");
  let webcamRunning=false;
  const videoHeight = "360px";
  const videoWidth = "480px";

  const canvasElement = document.getElementsByClassName('output_canvas')[0];
    
    canvasElement.width = window.innerWidth;
    canvasElement.height = window.innerHeight;
    
    const videoElement = document.getElementById('vid');
    const canvasCtx = canvasElement.getContext('2d');

  /********************************************************************
  // Demo 2: Continuously grab image from webcam stream and detect it.
  ********************************************************************/



  const video = document.getElementById("webcam") ;
  // const canvasCtx = canvasElement.getContext("2d");

  // Check if webcam access is supported.
  const hasGetUserMedia = () => !!(navigator.mediaDevices?.getUserMedia);

  // If webcam supported, add event listener to button for when user
  // wants to activate it.
  if (hasGetUserMedia()) {
  enableWebcamButton = document.getElementById("webcamButton");
  enableWebcamButton.addEventListener("click", enableCam);


  // Enable the live webcam view and start detection.
  function enableCam(event) {
  // if (!handLandmarker) {
  // console.log("Wait! objectDetector not loaded yet.");
  // return;
  // }

  console.log(webcamRunning)

  if (webcamRunning === true) {
  webcamRunning = false;
  enableWebcamButton.innerText = "ENABLE PREDICTIONS";
  } else {
  webcamRunning = true;
  enableWebcamButton.innerText = "DISABLE PREDICITONS";
  }

  // getUsermedia parameters.
  const constraints = {
  video: true
  };

  // Activate the webcam stream.
  navigator.mediaDevices.getUserMedia(constraints).then(async (stream) =>  {
  video.srcObject = stream;
  await hands.send({image: video});
  });
}};

var start=0;
function coordsForW(x, y, z) {
      // console.log(x,y);
      var element = document.getElementById('gameBlock');
      var Bx = (element.clientWidth / 100);
      var By = (element.clientHeight / 100);
      // console.log(Bx*x,By*y);

      document.getElementById('WLine').style = `height:5px;width:5px;position: absolute;top: ${By * y}px;right: ${Bx * x}px;background-color: green;transform: rotate(90deg);`
      // document.getElementById('hLine').style=`height:5px;width:100%;position: absolute;top:${By*y}px;left:0px;background-color: aqua;`
    }
    function coordsForP(x, y, z) {
      console.log(x, y, z);
      var element = document.getElementById('gameBlock');
      var Bx = (element.clientWidth / 100);
      var By = (element.clientHeight / 100);
      // console.log(Bx*x,By*y);

      // console.log(element.clientWidth,element.clientHeight)
      document.getElementById('PLine').style = `height:5px;width:5px;position: absolute;top: ${By * y}px;right: ${Bx * x}px;background-color: yellow;transform: rotate(90deg);`
      // document.getElementById('hLine').style=`height:5px;width:100%;position: absolute;top:${By*y}px;left:0px;background-color: aqua;`
    }
    function coordsForT(x, y, z) {
      console.log(x, y, z);
      var element = document.getElementById('gameBlock');
      var Bx = (element.clientWidth / 100);
      var By = (element.clientHeight / 100);
      // console.log(Bx*x,By*y);

      // console.log(element.clientWidth,element.clientHeight)
      document.getElementById('TLine').style = `height:5px;width:5px;position: absolute;top: ${By * y}px;right: ${Bx * x}px;background-color: red;transform: rotate(90deg);`
      // document.getElementById('hLine').style=`height:5px;width:100%;position: absolute;top:${By*y}px;left:0px;background-color: aqua;`
    }


    var max = 0, count = 0, oldmax = 0;
    console.log(canvasElement.height)
    function onResults(results) {
      canvasCtx.save();
      canvasCtx.clearRect(0, 0, canvasElement.width, canvasElement.height);
      canvasCtx.drawImage(
        results.image, 0, 0, canvasElement.width, canvasElement.height);
      if (results.multiHandLandmarks) {
        for (const landmarks of results.multiHandLandmarks) {
          if (start == 0) {
            ox = landmarks[12].x;
            start++;
          } else {

            max = Math.abs(
              Math.sqrt(
                Math.abs((landmarks[5].x - landmarks[9].x) * (landmarks[5].x - landmarks[9].x)) +
                Math.abs((landmarks[5].y - landmarks[9].y) * (landmarks[5].y - landmarks[9].y))
              )) * canvasElement.width;;
            console.log(max);
            try {
              if (window.innerWidth < 1000) {
                document.getElementById('imgsec').style = `top:${(((landmarks[13].y + landmarks[14].y) / 2) * canvasElement.height)}px;
              right:${(((landmarks[13].x + landmarks[14].x) / 2) * canvasElement.width) - (window.innerWidth * 0.003)}px
              ;z-index:1;background-color: transparent;width: ${max}px;height: auto;position: absolute;transform:translate(50%,-50%);`
              } else {
                document.getElementById('imgsec').style = `top:${(((landmarks[13].y + landmarks[14].y) / 2) * canvasElement.height)}px;
              right:${(((landmarks[13].x + landmarks[14].x) / 2) * canvasElement.width) - (window.innerWidth * 0.01)}px
              ;z-index:1;background-color: transparent;width: ${max}px;height: auto;position: absolute;transform:translate(50%,-50%);`

              }
            } catch (e) {
              console.log(e)
            }
            // coords(landmarks[12].x * 100, landmarks[12].y * 100)
          }

          // var deg = Math.atan((landmarks[4].y - landmarks[20].y) / (landmarks[4].x - landmarks[20].x)) * 180 / 3.14;
          // if (deg < 0) {
          //   deg = 180 + deg;
          // } else {
          //   deg = deg;
          // }
          // console.log(Math.round(90-deg))
          // if (Math.round(90 - deg) % 10 == 0) {
          //   document.getElementById('rectForTM').style.transform = `rotate(${90 - deg}deg)`;
          //   document.getElementById('rectForMM').style.transform = `rotate(${90 - deg}deg)`;
          //   document.getElementById('rectForBM').style.transform = `rotate(${90 - deg}deg)`;
          // }


          drawConnectors(canvasCtx, landmarks, HAND_CONNECTIONS,
            { color: 'yellow', lineWidth: 2 });
          // drawLandmarks(canvasCtx, landmarks, {color: '#FF0000', lineWidth: 1});
        }
      }
      canvasCtx.restore();
    }
const hands = new Hands({locateFile: (file) => {
  return `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`;
}});
hands.setOptions({
  maxNumHands: 2,
  modelComplexity: 1,
  minDetectionConfidence: 0.5,
  minTrackingConfidence: 0.5
});
hands.onResults(onResults);

const camera = new Camera(video, {
  onFrame: async () => {
    await hands.send({image: video});
  },
  width: 1280,
  height: 720
});
        
camera.start();
  </script>
</body>

</html>
